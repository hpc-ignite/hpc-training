# 14 р╕гр╕╣р╣Йр╕Ир╕│р╕Хр╕▒р╕зр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕ер╕▓р╕вр╕бр╕╖р╕н

## р╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Чр╕▓р╕Зр╕Чр╕др╕йр╕Ор╕╡

**1. Neural Network р╕Др╕╖р╕нр╕нр╕░р╣Др╕г?**  
Neural Network (р╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕вр╕Ыр╕гр╕░р╕кр╕▓р╕Чр╣Ар╕Чр╕╡р╕вр╕б) р╣Ар╕Ыр╣Зр╕Щр╣Бр╕Ър╕Ър╕Ир╕│р╕ер╕нр╕Зр╕Чр╕▓р╕Зр╕Др╕Ур╕┤р╕Хр╕ир╕▓р╕кр╕Хр╕гр╣Мр╕Чр╕╡р╣Ир╣Др╕Фр╣Йр╕гр╕▒р╕Ър╣Бр╕гр╕Зр╕Ър╕▒р╕Щр╕Фр╕▓р╕ер╣Гр╕Ир╕Ир╕▓р╕Бр╕кр╕бр╕нр╕Зр╕бр╕Щр╕╕р╕йр╕вр╣М р╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Фр╣Йр╕зр╕в "р╣Ар╕Лр╕ер╕ер╣Мр╕Ыр╕гр╕░р╕кр╕▓р╕Ч" (neurons) р╕Чр╕╡р╣Ир╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Щр╕Ьр╣Ир╕▓р╕Щ "р╕Лр╕┤р╕Щр╣Бр╕Щр╕Ыр╕кр╣М" (synapses) р╕Лр╕╢р╣Ир╕Зр╣Бр╕Хр╣Ир╕ер╕░р╣Ар╕Лр╕ер╕ер╣Мр╕Ир╕░р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Щр╕▒р╣Йр╕Щр╕Ьр╣Ир╕▓р╕Щр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Чр╕▓р╕Зр╕Др╕Ур╕┤р╕Хр╕ир╕▓р╕кр╕Хр╕гр╣М р╣Ар╕Кр╣Ир╕Щ р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ activation р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Др╕Фр╣Йр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕в

**2. Convolutional Neural Network (CNN)**  
CNN р╕Цр╕╣р╕Бр╕нр╕нр╕Бр╣Бр╕Ър╕Ър╕бр╕▓р╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕бр╕╡р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕Ыр╣Зр╕Щр╕Хр╕▓р╕гр╕▓р╕З р╣Ар╕Кр╣Ир╕Щ р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю р╣Вр╕Фр╕вр╣Гр╕Кр╣Йр╣Ар╕ер╣Ар╕вр╕нр╕гр╣М convolution р╕Чр╕╡р╣Ир╕Кр╣Ир╕зр╕вр╕Ир╕▒р╕Ър╕ер╕▒р╕Бр╕йр╕Ур╕░р╣Ар╕Фр╣Ир╕Щр╕Вр╕нр╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╕нр╕З pattern р╕Хр╣Ир╕▓р╕З р╣Ж р╣Ар╕Кр╣Ир╕Щ р╕Вр╕нр╕Ъ р╕гр╕╣р╕Ыр╕гр╣Ир╕▓р╕З р╣Бр╕ер╕░р╕ер╕зр╕Фр╕ер╕▓р╕в р╕ар╕▓р╕вр╣Гр╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╣Зр╕Бр╕Хр╣Мр╕Щр╕╡р╣Й р╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й CNN р╣Гр╕Щр╕Бр╕▓р╕гр╕Ир╕│р╣Бр╕Щр╕Бр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╕Ир╕▓р╕Бр╕Кр╕╕р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е MNIST

**3. Distributed Data Parallel (DDP)**  
р╕Бр╕▓р╕гр╕Эр╕╢р╕Б Neural Network р╣Гр╕Щр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕Зр╕нр╕▓р╕Ир╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Йр╣Ар╕зр╕ер╕▓р╕Щр╕▓р╕Щ р╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕Ир╕▓р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╣Вр╕бр╣Ар╕Фр╕ер╕бр╕╡р╕Вр╕Щр╕▓р╕Фр╣Гр╕лр╕Нр╣И DDP р╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╕Бр╕гр╕░р╕Ир╕▓р╕вр╕Зр╕▓р╕Щр╣Др╕Ыр╕вр╕▒р╕Зр╕лр╕ер╕▓р╕в р╣Ж GPU р╕Чр╕│р╣Гр╕лр╣Йр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Ар╕Ыр╣Зр╕Щр╣Др╕Ыр╕нр╕вр╣Ир╕▓р╕Зр╕гр╕зр╕Фр╣Ар╕гр╣Зр╕зр╣Бр╕ер╕░р╕бр╕╡р╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕бр╕▓р╕Бр╕Вр╕╢р╣Йр╕Щ  
- DDP р╣Бр╕Ър╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕нр╕Бр╣Ар╕Ыр╣Зр╕Щр╕кр╣Ир╕зр╕Щ р╣Ж р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Бр╕Хр╣Ир╕ер╕░ GPU р╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕Щр╕кр╣Ир╕зр╕Щр╕Вр╕нр╕Зр╕Хр╕▒р╕зр╣Ар╕нр╕Зр╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ р╕Ир╕▓р╕Бр╕Щр╕▒р╣Йр╕Щр╕Ир╕░р╕гр╕зр╕бр╕Ьр╕ер╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Ар╕Юр╕╖р╣Ир╕нр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕лр╣Йр╕Фр╕╡р╕Чр╕╡р╣Ир╕кр╕╕р╕Ф  
- р╕Бр╕▓р╕гр╣Гр╕Кр╣Й DDP р╕Хр╣Йр╕нр╕Зр╕бр╕╡р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ environment variables р╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б (р╣Ар╕Кр╣Ир╕Щ MASTER_PORT, WORLD_SIZE р╣Ар╕Ыр╣Зр╕Щр╕Хр╣Йр╕Щ) р╕Лр╕╢р╣Ир╕Зр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Фр╕╣р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Др╕Фр╣Йр╣Гр╕Щр╣Др╕Яр╕ер╣М `submit.sh` юИАciteюИВturn0file3юИБ

**4. р╣Бр╕Щр╕зр╕Др╕┤р╕Фр╕кр╕│р╕Др╕▒р╕Нр╕нр╕╖р╣Ир╕Щ р╣Ж**  
- **Gradient Descent р╣Бр╕ер╕░ Backpropagation:** р╕зр╕┤р╕Шр╕╡р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Щр╣Йр╕│р╕лр╕Щр╕▒р╕Бр╕Вр╕нр╕З Neural Network р╣Вр╕Фр╕вр╕Др╣Ир╕нр╕в р╣Ж р╕ер╕Фр╕Др╣Ир╕▓ loss р╕Чр╕╡р╣Ир╣Ар╕Бр╕┤р╕Фр╕Вр╕╢р╣Йр╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╕Эр╕╢р╕Б  
- **Dropout:** р╣Ар╕Чр╕Др╕Щр╕┤р╕Др╕Чр╕╡р╣Ир╕Кр╣Ир╕зр╕вр╕ер╕Фр╕Бр╕▓р╕г overfitting р╣Вр╕Фр╕вр╕Бр╕▓р╕гр╕кр╕╕р╣Ир╕бр╕Ыр╕┤р╕Фр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Ар╕Лр╕ер╕ер╣Мр╕Ър╕▓р╕Зр╕кр╣Ир╕зр╕Щр╕гр╕░р╕лр╕зр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╕Эр╕╢р╕Б р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Вр╕бр╣Ар╕Фр╕ер╣Др╕бр╣Ир╕Юр╕╢р╣Ир╕Зр╕Юр╕▓р╣Ар╕Лр╕ер╕ер╣Мр╣Гр╕Фр╣Ар╕Лр╕ер╕ер╣Мр╕лр╕Щр╕╢р╣Ир╕Зр╕бр╕▓р╕Бр╣Ар╕Бр╕┤р╕Щр╣Др╕Ы  
- **Normalization:** р╕Бр╕▓р╕гр╕Ыр╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╣Йр╕бр╕╡р╕кр╣Ар╕Бр╕ер╕Чр╕╡р╣Ир╣Ар╕лр╕бр╕▓р╕░р╕кр╕б р╕Лр╕╢р╣Ир╕Зр╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╕гр╕зр╕Фр╣Ар╕гр╣Зр╕зр╣Бр╕ер╕░р╕бр╕╡р╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Ю

---

## р╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╣Ир╕нр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щ

**р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╕гр╕╣р╣Йр╕Ир╕▒р╕Бр╕Бр╕▒р╕Ър╣Вр╕Ыр╕гр╣Ар╕Ир╣Зр╕Бр╕Хр╣Мр╕Щр╕╡р╣Йр╕Бр╣Ир╕нр╕Щ**  
р╣Гр╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╣Зр╕Бр╕Хр╣Мр╕Щр╕╡р╣Й р╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕Ир╕░р╣Др╕Фр╣Йр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Вр╣Йр╕нр╕бр╕╣р╕е MNIST р╕Лр╕╢р╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╕Чр╕╡р╣Ир╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕ер╕▓р╕вр╕бр╕╖р╕н р╣Бр╕ер╕░р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕бр╣Ар╕Фр╕е CNN р╣Вр╕Фр╕вр╣Гр╕Кр╣Й PyTorch р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Ъ Distributed Data Parallel (DDP) р╣Ар╕Юр╕╖р╣Ир╕нр╕Эр╕╢р╕Бр╕Ър╕Щр╕лр╕ер╕▓р╕в GPU р╣Гр╕Щр╕Лр╕╣р╣Ар╕Ыр╕нр╕гр╣Мр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М

---

**р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е MNIST**  
- р╣Ар╕Ыр╕┤р╕Фр╣Др╕Яр╕ер╣М `dataset_download.py` р╕Лр╕╢р╣Ир╕Зр╕Ир╕░р╕Чр╕│р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е MNIST р╕Ир╕▓р╕Бр╕нр╕┤р╕Щр╣Ар╕Чр╕нр╕гр╣Мр╣Ар╕Щр╣Зр╕Хр╣Др╕Ыр╣Ар╕Бр╣Зр╕Ър╣Др╕зр╣Йр╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Ф  
- р╣Ар╕бр╕╖р╣Ир╕нр╕гр╕▒р╕Щр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Щр╕╡р╣Й р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Ир╕░р╣Ар╕Кр╣Зр╕Др╕зр╣Ир╕▓р╕бр╕╡р╣Др╕Яр╕ер╣Мр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕нр╕вр╕╣р╣Ир╣Бр╕ер╣Йр╕зр╕лр╕гр╕╖р╕нр╕вр╕▒р╕З р╕Цр╣Йр╕▓р╣Др╕бр╣Ир╕бр╕╡р╕Ир╕░р╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕бр╕▓р╣Гр╕лр╕бр╣Ир╣Гр╕лр╣Й  
- р╣Гр╕лр╣Йр╕гр╕▒р╕Щр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Щр╣Ар╕Чр╕нр╕гр╣Мр╕бр╕┤р╕Щр╕▒р╕ер╕зр╣Ир╕▓  
  ```
  python dataset_download.py
  ```  
- р╣Ар╕бр╕╖р╣Ир╕нр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И р╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕Ир╣Йр╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б тАЬтЬЕ MNIST dataset downloaded successfully!тАЭ юИАciteюИВturn0file0юИБ

---

**р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕кр╕│р╕гр╕зр╕Ир╣Вр╕Др╣Йр╕Фр╣Гр╕Щр╣Др╕Яр╕ер╣М `DDP.py`**  
- р╣Вр╕Др╣Йр╕Фр╣Гр╕Щр╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Йр╕Ир╕░р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕бр╣Ар╕Фр╕е CNN р╕Чр╕╡р╣Ир╕Ыр╕гр╕░р╕Бр╕нр╕Ър╕Фр╣Йр╕зр╕вр╣Ар╕ер╣Ар╕вр╕нр╕гр╣Мр╕Др╕нр╕Щр╣Вр╕зр╕ер╕╣р╕Кр╕▒р╕Щр╣Бр╕ер╕░ Fully Connected Layer  
- р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щ `train()` р╣Бр╕ер╕░ `test()` р╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Эр╕╢р╕Бр╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╣Вр╕бр╣Ар╕Фр╕ер╕Хр╕▓р╕бр╕ер╕│р╕Фр╕▒р╕Ъ  
- р╕бр╕╡р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ Distributed Data Parallel (DDP) р╣Ар╕Юр╕╖р╣Ир╕нр╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╕Ър╕Щр╕лр╕ер╕▓р╕в GPU р╕Юр╕гр╣Йр╕нр╕бр╕Бр╕▒р╕Щ р╕Лр╕╢р╣Ир╕Зр╕Кр╣Ир╕зр╕вр╣Ар╕гр╣Ир╕Зр╕Др╕зр╕▓р╕бр╣Ар╕гр╣Зр╕зр╣Гр╕Щр╕Бр╕▓р╕гр╕Эр╕╢р╕Б  
- р╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕Др╕зр╕гр╕нр╣Ир╕▓р╕Щр╣Вр╕Др╣Йр╕Фр╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╣Ар╕лр╣Зр╕Щр╣Гр╕Щр╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕лр╕ер╕▒р╕Бр╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕кр╣Ир╕зр╕Щ юИАciteюИВturn0file1юИБ

---

**р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Бр╕▓р╕гр╕гр╕▒р╕Щр╕Ър╕Щр╕Лр╕╣р╣Ар╕Ыр╕нр╕гр╣Мр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М**  
- р╣Ар╕Ыр╕┤р╕Фр╣Др╕Яр╕ер╣М `submit.sh` р╕Лр╕╢р╣Ир╕Зр╕бр╕╡р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕кр╕│р╕лр╕гр╕▒р╕Ъ SLURM р╣Гр╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Зр╕▓р╕Щр╕Ър╕Щр╕Лр╕╣р╣Ар╕Ыр╕нр╕гр╣Мр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣М  
- р╣Гр╕Щр╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Й р╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕Ир╕░р╣Др╕Фр╣Йр╕Бр╕│р╕лр╕Щр╕Фр╕Чр╕гр╕▒р╕Юр╕вр╕▓р╕Бр╕гр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й (р╣Ар╕Кр╣Ир╕Щ GPU р╕Ир╕│р╕Щр╕зр╕Щ 4 р╕Хр╕▒р╕з) р╣Бр╕ер╕░р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ environment variables р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ DDP  
- р╣Ар╕бр╕╖р╣Ир╕нр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕гр╕▒р╕Щр╕Зр╕▓р╕Щ р╣Гр╕лр╣Йр╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕Зр╣Гр╕Щр╣Ар╕Чр╕нр╕гр╣Мр╕бр╕┤р╕Щр╕▒р╕ер╕зр╣Ир╕▓  
  ```
  sbatch submit.sh
  ```  
- р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕Ир╕▒р╕Фр╕кр╕гр╕гр╕Чр╕гр╕▒р╕Юр╕вр╕▓р╕Бр╕гр╣Бр╕ер╕░р╣Ар╕гр╕┤р╣Ир╕бр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕лр╣Йр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤ юИАciteюИВturn0file3юИБ

---

**р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 5: р╕Фр╕╣р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╣Бр╕ер╕░р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣М**  
- р╣Ар╕бр╕╖р╣Ир╕нр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕┤р╣Йр╕Щ р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Ир╕░р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ър╕Ьр╣Ир╕▓р╕Щр╕Чр╕▓р╕Зр╣Ар╕Чр╕нр╕гр╣Мр╕бр╕┤р╕Щр╕▒р╕е  
- р╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕▒р╕Зр╣Ар╕Бр╕Хр╕Бр╕▓р╕гр╕ер╕Фр╕ер╕Зр╕Вр╕нр╕З loss р╣Бр╕ер╕░р╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╕Вр╕╢р╣Йр╕Щр╕Вр╕нр╕Зр╕Др╕зр╕▓р╕бр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕Хр╕▓р╕бр╕Ир╕│р╕Щр╕зр╕Щ epoch р╕Чр╕╡р╣Ир╕Бр╕│р╕лр╕Щр╕Фр╣Др╕зр╣Й  
- р╕лр╕▓р╕Бр╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Вр╕бр╣Ар╕Фр╕ер╕кр╕╕р╕Фр╕Чр╣Йр╕▓р╕вр╣Др╕зр╣Йр╣Гр╕Кр╣Йр╣Гр╕Щр╕нр╕Щр╕▓р╕Др╕Х р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╕Хр╕▒р╕зр╣Ар╕ер╕╖р╕нр╕Б `--save-model` р╣Гр╕Щр╕Бр╕▓р╕гр╕гр╕▒р╕Щр╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╣Др╕Фр╣Й

---

**р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 6: р╕ер╕нр╕Зр╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕Зр╣Бр╕ер╕░р╕Чр╕Фр╕ер╕нр╕Зр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б**  
- р╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Ыр╕гр╕▒р╕Ър╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Юр╕▓р╕гр╕▓р╕бр╕┤р╣Ар╕Хр╕нр╕гр╣Мр╕Хр╣Ир╕▓р╕З р╣Ж р╣Ар╕Кр╣Ир╕Щ р╕Ир╕│р╕Щр╕зр╕Щ epoch, batch size, learning rate р╕лр╕гр╕╖р╕нр╣Бр╕бр╣Йр╕Бр╕гр╕░р╕Чр╕▒р╣Ир╕Зр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Вр╕нр╕Зр╣Вр╕бр╣Ар╕Фр╕е (р╣Ар╕Кр╣Ир╕Щ р╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕ер╣Ар╕вр╕нр╕гр╣Мр╕лр╕гр╕╖р╕нр╕Ыр╕гр╕▒р╕Ъ dropout) р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕Ьр╕ер╕Бр╕гр╕░р╕Чр╕Ър╕Хр╣Ир╕нр╕Ыр╕гр╕░р╕кр╕┤р╕Чр╕Шр╕┤р╕ар╕▓р╕Юр╕Вр╕нр╕Зр╣Вр╕бр╣Ар╕Фр╕е  
- р╕Фр╕╣р╣Др╕Яр╕ер╣М `load_data.py` р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Вр╣Йр╕▓р╣Гр╕Ир╕Бр╕▓р╕гр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Бр╕ер╕░р╕Бр╕▓р╕гр╣Бр╕Ыр╕ер╕З (transform) р╕Вр╣Йр╕нр╕бр╕╣р╕е р╕Лр╕╢р╣Ир╕Зр╣Ар╕Ыр╣Зр╕Щр╕кр╣Ир╕зр╕Щр╕кр╕│р╕Др╕▒р╕Нр╣Гр╕Щр╕Бр╕▓р╕гр╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Бр╣Ир╕нр╕Щр╕Эр╕╢р╕Б юИАciteюИВturn0file2юИБ

---

**р╕кр╕гр╕╕р╕Ы:**  
р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╣Др╕Фр╣Йр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Йр╕Чр╕▒р╣Йр╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щр╕Чр╕▓р╕Зр╕Чр╕др╕йр╕Ор╕╡р╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Ыр╕Пр╕┤р╕Ър╕▒р╕Хр╕┤р╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╣Бр╕ер╕░р╕Эр╕╢р╕Б Neural Network р╕Ър╕Щр╕Лр╕╣р╣Ар╕Ыр╕нр╕гр╣Мр╕Др╕нр╕бр╕Юр╕┤р╕зр╣Ар╕Хр╕нр╕гр╣Мр╣Бр╕ер╣Йр╕з! р╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Фр╕▓р╕зр╕Щр╣Мр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕е MNIST р╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕бр╣Ар╕Фр╕е CNN р╣Бр╕ер╕░р╕Бр╕▓р╕гр╣Гр╕Кр╣Й Distributed Data Parallel (DDP) р╣Гр╕Щр╕Бр╕▓р╕гр╕Эр╕╢р╕Бр╕Ър╕Щр╕лр╕ер╕▓р╕в GPU р╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕Ир╕░р╣Др╕Фр╣Йр╣Ар╕лр╣Зр╕Щр╕ар╕▓р╕Юр╕гр╕зр╕бр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Ыр╕гр╕░р╕вр╕╕р╕Бр╕Хр╣Мр╣Гр╕Кр╣Йр╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕Вр╕▒р╣Йр╕Щр╕кр╕╣р╕Зр╣Гр╕Щр╕Зр╕▓р╕Щр╕зр╕┤р╕Ир╕▒р╕вр╣Бр╕ер╕░р╕нр╕╕р╕Хр╕кр╕▓р╕лр╕Бр╕гр╕гр╕б  
р╕ер╕нр╕Зр╕Чр╕│р╕Хр╕▓р╕бр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕╡р╣Йр╕Фр╕╣ р╣Бр╕ер╣Йр╕зр╕Щр╕▒р╕Бр╣Ар╕гр╕╡р╕вр╕Щр╕Ир╕░р╣Др╕Фр╣Йр╕Юр╕Ър╕Бр╕▒р╕Ър╣Вр╕ер╕Бр╣Бр╕лр╣Ир╕Зр╕Ыр╕▒р╕Нр╕Нр╕▓р╕Ыр╕гр╕░р╕Фр╕┤р╕йр╕Рр╣Мр╣Бр╕ер╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Чр╕Фр╕ер╕нр╕Зр╕Ыр╕гр╕▒р╕Ър╕Ыр╕гр╕╕р╕Зр╕Щр╕зр╕▒р╕Хр╕Бр╕гр╕гр╕бр╕Вр╕нр╕Зр╕Хр╕Щр╣Ар╕нр╕Зр╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Хр╣Зр╕бр╕Чр╕╡р╣И!
---
### **ЁЯФе р╕Др╕╣р╣Ир╕бр╕╖р╕нр╣Бр╕Ър╕Ър╕Чр╕╡р╕ер╕░р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щ: р╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕е MNIST р╕Ър╕Щ ONNX р╣Бр╕ер╕░р╕гр╕▒р╕Щр╕Ър╕Щр╣Ар╕зр╣Зр╕Ър╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М**

р╣Гр╕Щр╕Др╕╣р╣Ир╕бр╕╖р╕нр╕Щр╕╡р╣Й р╣Ар╕гр╕▓р╕Ир╕░ **р╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕е PyTorch MNIST (`mnist_cnn.pt`) р╣Ар╕Ыр╣Зр╕Щ ONNX** р╣Бр╕ер╕░ **р╕Щр╕│р╣Др╕Ыр╣Гр╕Кр╣Йр╕Ър╕Щр╣Ар╕зр╣Зр╕Ър╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М** р╣Вр╕Фр╕вр╣Гр╕Кр╣Й **ONNX Runtime Web (onnxruntime-web)** р╕Лр╕╢р╣Ир╕Зр╕Кр╣Ир╕зр╕вр╣Гр╕лр╣Йр╣Ар╕гр╕▓р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Вр╕бр╣Ар╕Фр╕ер╣Др╕Фр╣Й **р╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕бр╕╡р╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣Мр╣Бр╕Ър╣Зр╕Бр╣Ар╕нр╕Щр╕Фр╣М**

---

## **ЁЯУМ р╕кр╕┤р╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Ир╕░р╕Чр╕│**

тЬЕ **р╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕ер╕Ир╕▓р╕Б PyTorch р╣Ар╕Ыр╣Зр╕Щ ONNX**  
тЬЕ **р╣Вр╕лр╕ер╕Фр╣Бр╕ер╕░р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Вр╕бр╣Ар╕Фр╕ер╣Гр╕Щ JavaScript р╕Ьр╣Ир╕▓р╕Щ onnxruntime-web**  
тЬЕ **р╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ыр╕Чр╕╡р╣Ир╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕ар╕▓р╕Юр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕бр╕╖р╕н р╣Бр╕ер╕░р╣Гр╕лр╣Йр╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕│р╕Щр╕▓р╕в**

---

# **ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 1: р╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕е PyTorch р╣Ар╕Ыр╣Зр╕Щ ONNX**

р╕Бр╣Ир╕нр╕Щр╕нр╕╖р╣Ир╕Щ р╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕Зр╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕╡р╣Ир╕Эр╕╢р╕Бр╕Ир╕▓р╕Б `DDP.py` р╣Гр╕лр╣Йр╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣М **ONNX** р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Гр╕Щр╣Ар╕зр╣Зр╕Ър╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣Мр╣Др╕Фр╣Й

### **тЬЕ р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Др╕ер╕Ър╕гр╕▓р╕гр╕╡р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ**

р╕гр╕▒р╕Щр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Хр╣Ир╕нр╣Др╕Ыр╕Щр╕╡р╣Йр╣Гр╕Щ Python:

```bash
module load Mamba
conda activate /project/cb900902-hpct01/envs/hpc-mesa
```

### **тЬЕ р╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕е**

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М **`convert_to_onnx.py`** р╣Бр╕ер╕░р╣Ар╕Юр╕┤р╣Ир╕бр╣Вр╕Др╣Йр╕Фр╕Хр╣Ир╕нр╣Др╕Ыр╕Щр╕╡р╣Й:
```bash
nano convert_to_onnx.py
```

```python
import torch
import onnx
from DDP import Net  # р╕Щр╕│р╣Ар╕Вр╣Йр╕▓р╣Вр╕бр╣Ар╕Фр╕ер╕Ир╕▓р╕Б DDP.py

# р╣Вр╕лр╕ер╕Фр╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕╡р╣Ир╣Ар╕Чр╕гр╕Щр╣Бр╕ер╣Йр╕з
model = Net()
model.load_state_dict(torch.load("mnist_cnn.pt", map_location=torch.device("cpu")))
model.eval()

# р╕кр╕гр╣Йр╕▓р╕Зр╕нр╕┤р╕Щр╕Юр╕╕р╕Хр╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕Кр╣Йр╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕е
dummy_input = torch.randn(1, 1, 28, 28)

# р╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕ер╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣М ONNX
onnx_file = "mnist.onnx"
torch.onnx.export(
    model, dummy_input, onnx_file,
    input_names=["input"], output_names=["output"],
    dynamic_axes={"input": {0: "batch_size"}, "output": {0: "batch_size"}}
)

print(f"тЬЕ р╣Вр╕бр╣Ар╕Фр╕ер╕Цр╕╣р╕Бр╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щ ONNX р╣Бр╕ер╕░р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Гр╕Щ {onnx_file}")
```

### **тЬЕ р╕гр╕▒р╕Щр╣Вр╕Др╣Йр╕Фр╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕е**

```bash
python convert_to_onnx.py
```

р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╕гр╕▒р╕Щр╣Ар╕кр╕гр╣Зр╕Ир╣Бр╕ер╣Йр╕з р╕Др╕╕р╕Ур╕Др╕зр╕гр╕бр╕╡р╣Др╕Яр╕ер╣М `mnist.onnx` р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Вр╕нр╕Зр╕Др╕╕р╕У тЬЕ

---

# **ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 2: р╣Вр╕лр╕ер╕Фр╣Вр╕бр╣Ар╕Фр╕е ONNX р╣Гр╕Щр╣Ар╕зр╣Зр╕Ър╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М**

## **тЬЕ 2.1 р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣Мр╣Ар╕Ър╕▓р╣Ж р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Чр╕Фр╕кр╕нр╕Ъ**

р╣Ар╕гр╕▓р╕Ир╕░р╣Гр╕Кр╣Й **Python HTTP Server** р╣Ар╕Юр╕╖р╣Ир╕нр╣Вр╕ор╕кр╕Хр╣Мр╣Др╕Яр╕ер╣М `mnist.onnx` р╣Бр╕ер╕░р╣Др╕Яр╕ер╣Мр╣Ар╕зр╣Зр╕Ъ:

```bash
pip install flask
```

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М **`server.py`**:

```python
from flask import Flask, send_from_directory

app = Flask(__name__)

@app.route("/")
def index():
    return send_from_directory(".", "index.html")

@app.route("/<path:path>")
def serve_file(path):
    return send_from_directory(".", path)

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000, debug=True)
```

---

## **тЬЕ 2.2 р╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ыр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣М**

р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М **`static/`** р╣Бр╕ер╕░р╣Ар╕Юр╕┤р╣Ир╕бр╣Др╕Яр╕ер╣М **`index.html`** р╕Вр╣Йр╕▓р╕Зр╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Щр╕╡р╣Й:

```html
<!DOCTYPE html>

<html lang="th">

<head>

┬а ┬а <meta charset="UTF-8">

┬а ┬а <title>р╕Чр╕│р╕Щр╕▓р╕вр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╕Фр╣Йр╕зр╕в MNIST (ONNX)</title>

┬а ┬а <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js" defer></script>

</head>

<body>

┬а ┬а <h1>р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕бр╕╖р╕н</h1>

┬а ┬а <input type="file" id="fileInput">

┬а ┬а <button onclick="predict()">р╕Чр╕│р╕Щр╕▓р╕в</button>

┬а ┬а <p id="result"></p>

  

┬а ┬а <script>

┬а ┬а ┬а ┬а document.addEventListener("DOMContentLoaded", async function () {

┬а ┬а ┬а ┬а ┬а ┬а if (typeof ort === "undefined") {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а console.error("ONNX Runtime Web (ort) is not defined. Check if the script is correctly included.");

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а return;

┬а ┬а ┬а ┬а ┬а ┬а }

  

┬а ┬а ┬а ┬а ┬а ┬а async function predict() {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let fileInput = document.getElementById("fileInput");

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а if (!fileInput.files.length) {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а alert("р╕Бр╕гр╕╕р╕Ур╕▓р╣Ар╕ер╕╖р╕нр╕Бр╣Др╕Яр╕ер╣Мр╕ар╕▓р╕Ю!");

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а return;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }

  

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let file = fileInput.files[0];

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let reader = new FileReader();

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а reader.onload = async function(event) {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let img = new Image();

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а img.src = event.target.result;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а img.onload = async function() {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let canvas = document.createElement("canvas");

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а canvas.width = 28;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а canvas.height = 28;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let ctx = canvas.getContext("2d");

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ctx.drawImage(img, 0, 0, 28, 28);

  

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let imageData = ctx.getImageData(0, 0, 28, 28).data;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let inputTensor = new Float32Array(1 * 1 * 28 * 28);

  

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а for (let i = 0; i < 28 * 28; i++) {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а inputTensor[i] = imageData[i * 4] / 255.0;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }

  

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а try {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let session = await ort.InferenceSession.create("mnist.onnx");

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let results = await session.run({ "input": new ort.Tensor("float32", inputTensor, [1, 1, 28, 28]) });

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let output = results.output.data;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а let predictedDigit = output.indexOf(Math.max(...output));

  

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а document.getElementById("result").innerText = "р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: " + predictedDigit;

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а } catch (error) {

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а console.error("Error running ONNX model:", error);

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а }

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а };

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а };

┬а ┬а ┬а ┬а ┬а ┬а ┬а ┬а reader.readAsDataURL(file);

┬а ┬а ┬а ┬а ┬а ┬а }

  

┬а ┬а ┬а ┬а ┬а ┬а window.predict = predict;

┬а ┬а ┬а ┬а });

┬а ┬а </script>

</body>

</html>
```

---

# **ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 3: р╕гр╕▒р╕Щр╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣Мр╣Бр╕ер╕░р╕Чр╕Фр╕кр╕нр╕Ъ**

## **тЬЕ 3.1 р╕гр╕▒р╕Щр╣Ар╕Лр╕┤р╕гр╣Мр╕Яр╣Ар╕зр╕нр╕гр╣М**

```bash
python server.py
```

## **тЬЕ 3.2 р╣Ар╕Ыр╕┤р╕Фр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ы**

ЁЯУМ **р╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣Мр╕Вр╕нр╕Зр╕Др╕╕р╕Ур╣Др╕Ыр╕Чр╕╡р╣И** тЖТ [http://127.0.0.1:5000/](http://127.0.0.1:5000/)  
ЁЯУМ **р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕ар╕▓р╕Юр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Ар╕Вр╕╡р╕вр╕Щр╕Фр╣Йр╕зр╕вр╕бр╕╖р╕н р╣Бр╕ер╕░р╣Гр╕лр╣Йр╣Вр╕бр╣Ар╕Фр╕е ONNX р╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣М**

тЬЕ р╕Др╕╕р╕Ур╕Ир╕░р╣Ар╕лр╣Зр╕Щр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╣Вр╕бр╣Ар╕Фр╕ер╕Чр╕│р╕Щр╕▓р╕в р╣Ар╕Кр╣Ир╕Щ:

```
р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: 7
```

---

# **ЁЯФ╣ р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Чр╕╡р╣И 4: р╕Щр╕│р╣Др╕Ыр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Ир╕гр╕┤р╕З**

## тЬЕ **р╣Вр╕ор╕кр╕Хр╣Мр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ы**

р╕Др╕╕р╕Ур╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Вр╕ор╕кр╕Хр╣Мр╣Бр╕нр╕Ыр╕Ър╕Щ **GitHub Pages, Vercel, Netlify р╕лр╕гр╕╖р╕н Firebase Hosting** р╣Ар╕Юр╕╖р╣Ир╕нр╣Гр╕лр╣Йр╣Ар╕Вр╣Йр╕▓р╕Цр╕╢р╕Зр╕нр╕нр╕Щр╣Др╕ер╕Щр╣Мр╣Др╕Фр╣Й

## тЬЕ **р╕Чр╕│р╣Гр╕лр╣Йр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕бр╕╖р╕нр╕Цр╕╖р╕н**

р╕Ыр╕гр╕▒р╕Ър╣Бр╕Хр╣Ир╕З **UI р╕Вр╕нр╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ы** р╣Вр╕Фр╕вр╣Гр╕Кр╣Й **HTML + CSS** р╣Гр╕лр╣Йр╕гр╕нр╕Зр╕гр╕▒р╕Ъ **р╕бр╕╖р╕нр╕Цр╕╖р╕нр╣Бр╕ер╕░р╣Бр╕Чр╣Зр╕Ър╣Ар╕ер╣Зр╕Х**

---

# **ЁЯФ╣ р╕кр╕гр╕╕р╕Ы**

тЬЕ **р╣Бр╕Ыр╕ер╕Зр╣Вр╕бр╣Ар╕Фр╕е PyTorch (`mnist_cnn.pt`) р╣Ар╕Ыр╣Зр╕Щ ONNX (`mnist.onnx`)**  
тЬЕ **р╕кр╕гр╣Йр╕▓р╕Зр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ыр╕Чр╕╡р╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕ар╕▓р╕Юр╣Бр╕ер╕░р╣Гр╕Кр╣Йр╣Вр╕бр╣Ар╕Фр╕е ONNX р╕Чр╕│р╕Бр╕▓р╕гр╕Юр╕вр╕▓р╕Бр╕гр╕Ур╣М**  
тЬЕ **р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ ONNX Runtime Web р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕▒р╕Щр╣Вр╕бр╣Ар╕Фр╕ер╣Вр╕Фр╕вр╕Хр╕гр╕Зр╣Гр╕Щр╣Ар╕зр╣Зр╕Ър╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М**  
тЬЕ **р╕Чр╕│р╣Гр╕лр╣Йр╣Ар╕зр╣Зр╕Ър╣Бр╕нр╕Ыр╕гр╕нр╕Зр╕гр╕▒р╕Ър╕бр╕╖р╕нр╕Цр╕╖р╕нр╣Бр╕ер╕░р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Вр╕ор╕кр╕Хр╣Мр╕нр╕нр╕Щр╣Др╕ер╕Щр╣Мр╣Др╕Фр╣Й**

**ЁЯФе р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╕Др╕╕р╕Ур╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕▒р╕Щр╣Вр╕бр╣Ар╕Фр╕е MNIST р╣Др╕Фр╣Йр╣Вр╕Фр╕вр╕Хр╕гр╕Зр╣Гр╕Щр╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣М! ЁЯЪА**

ЁЯУМ **р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕нр╕░р╣Др╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕бр╣Др╕лр╕б? р╣Ар╕Кр╣Ир╕Щ р╕Бр╕▓р╕гр╕зр╕▓р╕Фр╕Хр╕▒р╕зр╣Ар╕ер╕Вр╣Бр╕Чр╕Щр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ы? ЁЯШК**

